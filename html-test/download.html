<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>二维码</title>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <!--    <script type="text/javascript" src="http://static.runoob.com/assets/qrcode/qrcode.min.js"></script>-->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"
    ></script>

    <style type="text/css">
      html,
      body {
        width: 100%;
        height: 100%;
        flex-direction: column;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #qrcode {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      img {
        display: inline-block !important;
      }
    </style>
  </head>
  <body>
    <canvas id="qrcode"></canvas>
    <div style="margin-top: 30px">
      <a id="codeDow" download="二维码.png" href=""><h2>~点此下载~</h2></a>
    </div>

    <!-- <img src="https://pic1.zhimg.com/v2-708d96ec06656a99f4d5525d94b6a5c8_r.jpg" /> -->
  </body>
  <script>
    $(function () {
      let qrCode = GetQueryString("qr");

      let qr = new QRious({
        element: document.querySelector("#qrcode"),
        value:
          "https://pic1.zhimg.com/v2-708d96ec06656a99f4d5525d94b6a5c8_r.jpg",
      });
      let index = qr.toDataURL().indexOf(",");
      let href = qr.toDataURL().slice(index);
      $("#codeDow").attr("href", qr.toDataURL());
      alert(document.querySelector("#codeDow").href);
      alert(qr.toDataURL());
    });

    function GetQueryString(name) {
      var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
      var r = window.location.search.substr(1).match(reg);
      if (r != null) return r[2];
      return null;
    }
  </script>
</html>
